{% extends "docstring/base.html" %}
{% load docstring %}


{% block actions_items %}
{{block.super}}
{% if revision %}
<a href="{% url pydocweb.doc.views.docstring name %}">Current revision</a>
<span id="revision-header">Revision {{revision.revno}}</span>
{% else %}
<span id="review-status" class="{{status_code}}">
  {% if perms.doc.can_review %}
  <form action="{% url pydocweb.doc.views.review name %}" method="post">
    <ul>
      {{review_form.as_ul}}
      <li><input type="submit" value="Change" /></li>
    </ul>
  </form>
  {% else %}
    <ul>
      <li>Review status: {{status}}</li>
    </ul>
  {% endif %}
</span>
{% endif %}
{% endblock %}


{% block content %}
<div id="document">
  {{body}}
</div>

{% block discussion %}
<div id="comments">
  <h1><a id="discussion"/>Discussion</h1>
  {% for comment in comments %}
  <div class="comment">
    <div class="author">
      <span class="timestamp">{{comment.timestamp}}</span>
      <span class="author">{{comment.author}}</span>
    </div>
    {% if perms.doc.change_reviewcomment %}
    {% ifequal comment.author_username user.username %}
    <div class="edit-tools">
      <form action="{% url pydocweb.doc.views.comment_edit name,comment.id %}" method="GET">
	<input type=submit value="Edit"/>
      </form>
      
      <form action="{% url pydocweb.doc.views.comment_edit name,comment.id %}" method="POST">
	<input type=submit name="button_delete" value="Delete" />
      </form>
    </div>
    {% endifequal %}
    {% endif %}
    <div class="text">{{comment.text}}</div>
  </div>
  {% endfor %}
  {% if perms.doc.change_reviewcomment %}
  <form action="{% url pydocweb.doc.views.comment_edit name,"new" %}" method="GET">
    <input type=submit value="New comment"/>
  </form>
  {% endif %}
</div>
{% endblock %}


{% block docstring_contents %}

{% ifequal doc.type_ "module" %}
<div id="content-list">
  <h1>Modules</h1>
  <ul class="content-list">
    {% for alias in doc.child_modules %}
    <li class="{% docstring_status_code alias.target %}"><a href="{% url pydocweb.doc.views.docstring alias.target %}">{{alias.alias}}</a></li>
    {% endfor %}
  </ul>

  <h1>Classes</h1>
  <ul class="content-list">
    {% for alias in doc.child_classes %}
    <li class="{% docstring_status_code alias.target %}"><a href="{% url pydocweb.doc.views.docstring alias.target %}">{{alias.alias}}</a></li>
    {% endfor %}
  </ul>

  <h1>Functions</h1>
  <ul class="content-list">
    {% for alias in doc.child_callables %}
    <li class="{% docstring_status_code alias.target %}"><a href="{% url pydocweb.doc.views.docstring alias.target %}">{{alias.alias}}</a></li>
    {% endfor %}
  </ul>

  <h1>Objects</h1>
  <ul class="content-list">
    {% for alias in doc.child_objects %}
    <li class="{% docstring_status_code alias.target %}"><a href="{% url pydocweb.doc.views.docstring alias.target %}">{{alias.alias}}</a></li>
    {% endfor %}
  </ul>
</div>
{% endifequal %}

{% ifequal doc.type_ "class" %}
<div id="contents">
  <h1>Methods</h1>
  <ul class="content-list">
    {% for alias in doc.child_callables %}
    <li class="{% docstring_status_code alias.target %}"><a href="{% url pydocweb.doc.views.docstring alias.target %}">{{alias.alias}}</a></li>
    {% endfor %}
  </ul>

  <h1>Properties</h1>
  <ul class="content-list">
    {% for alias in doc.child_objects %}
    <li class="{% docstring_status_code alias.target %}"><a href="{% url pydocweb.doc.views.docstring alias.target %}">{{alias.alias}}</a></li>
    {% endfor %}
  </ul>
</div>
{% endifequal %}

{% endblock %}

{% endblock %}
